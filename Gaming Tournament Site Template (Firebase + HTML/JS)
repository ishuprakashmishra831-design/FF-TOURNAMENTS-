<!DOCTYPE html>
<html>
<head>
    <title>Gaming Tournament Site</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <h1>Gaming Tournament Site</h1>

    <!-- User Registration Form -->
    <h2>Register</h2>
    <input type="text" id="regName" placeholder="Name"><br>
    <input type="email" id="regEmail" placeholder="Email"><br>
    <input type="text" id="regGameId" placeholder="Game ID"><br>
    <input type="password" id="regPassword" placeholder="Password"><br>
    <button onclick="registerUser()">Register</button>

    <hr>

    <!-- Tournament List -->
    <h2>Available Tournaments</h2>
    <div id="tournamentList"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // User Registration
        function registerUser(){
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const gameId = document.getElementById('regGameId').value;
            const password = document.getElementById('regPassword').value;

            if(name && email && gameId && password){
                db.collection("users").add({
                    name: name,
                    email: email,
                    game_id: gameId,
                    password: password, // For security, hash if possible
                    created_at: firebase.firestore.FieldValue.serverTimestamp()
                })
                .then(() => alert("User Registered Successfully!"))
                .catch(error => console.error("Error: ", error));
            } else {
                alert("Please fill all fields!");
            }
        }

        // Fetch & Display Tournaments
        db.collection("tournaments").onSnapshot((snapshot) => {
            const list = document.getElementById('tournamentList');
            list.innerHTML = "";
            snapshot.forEach(doc => {
                const data = doc.data();
                const div = document.createElement('div');
                div.innerHTML = `
                    <h3>${data.name}</h3>
                    <p>Mode: ${data.game_mode}</p>
                    <p>Date: ${data.date}</p>
                    <p>Rules: ${data.rules}</p>
                    <button onclick="joinTournament('${doc.id}')">Join Tournament</button>
                    <hr>
                `;
                list.appendChild(div);
            });
        });

        // Join Tournament
        function joinTournament(tournamentId){
            const userId = prompt("Enter your User ID to join:");
            if(userId){
                db.collection("participants").add({
                    user_id: userId,
                    tournament_id: tournamentId,
                    status: "registered",
                    join_time: firebase.firestore.FieldValue.serverTimestamp()
                })
                .then(() => alert("Successfully joined tournament!"))
                .catch(error => console.error("Error: ", error));
            } else {
                alert("User ID required!");
            }
        }
    </script>
</body>
</html>
